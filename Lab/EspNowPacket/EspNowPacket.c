#include <stdint.h>
#include <stdio.h>

typedef struct __attribute__((__packed__))
{
    uint8_t radiotap_version;                  //= 0;
    uint8_t radiotap_pad;                      //= 0;
    uint16_t radiotap_lenght;                //= 0x00,0x26;
    uint32_t radiotap_present_1;             //= {0x2f, 0x40, 0x00, 0xa0};
    uint32_t radiotap_present_2;             //= {0x20, 0x08, 0x00, 0xa0};
    uint32_t radiotap_present_3;             //= {0x20, 0x08, 0x00, 0x00};
    uint64_t timestamp;                      //= {0xdf, 0x32, 0xfe, 0x1f, 0x00, 0x00, 0x00, 0x00};
    uint8_t radiotap_flags_shortgi;            //= 10;
    uint8_t radiotap_datarate;                 //0x0c
    uint16_t radiotap_channel_freq;          //0x6c, 0x09
    uint16_t radiotap_channel_flags_quarter; //0xc0, 0x00
    uint8_t radiotap_dbm;                      //0xd3
    uint8_t alone;                             //0x00,
    uint16_t radiotap_rxflags_badplcp;       // 0x00, 0x00
    uint8_t radiotap_dbm_antsignal1;           //0xd3
    uint8_t radiotap_antenna1;                 //0x00
    uint8_t radiotap_dbm_antsignal2;           //0xc7
    uint8_t radiotap_antenna2;                 //0x01

    uint8_t wlan_fc_subtype;          //0xd0
    uint8_t wlan_fc_order;            //0x00
    uint16_t wlan_duration;         //0x3a, 0x01
    uint8_t wlan_da[6];               //0x84, 0xf3, 0xeb, 0x73, 0x55, 0x0d
    uint8_t wlan_sa[6];               //0xf8, 0x1a, 0x67, 0xb7, 0xeb, 0x0b
    uint8_t wlan_bssid[6];            //0x84, 0xf3, 0xeb, 0x73, 0x55, 0x0d
    uint16_t wlan_seq;              //0x70, 0x51
    uint8_t wlan_fiwed_category_code; //0x7f
    uint8_t wlan_tag_oui[3];          //0x18,0xfe, 0x34

    uint8_t data[261];

    uint32_t wlan_fcs; //0x1c, 0xd5, 0x35, 0xd3

} espPacket;



uint8_t data[331] = {
    0x00, 0x00, 0x26, 0x00, 0x2f, 0x40, 0x00, 0xa0, 0x20, 0x08, 0x00, 0xa0, 0x20, 0x08, 0x00, 0x00,
    0xdf, 0x32, 0xfe, 0x1f, 0x00, 0x00, 0x00, 0x00, 0x10, 0x0c, 0x6c, 0x09, 0xc0, 0x00, 0xd3, 0x00,
    0x00, 0x00, 0xd3, 0x00, 0xc7, 0x01, 0xd0, 0x00, 0x3a, 0x01, 0x84, 0xf3, 0xeb, 0x73, 0x55, 0x0d,
    0xf8, 0x1a, 0x67, 0xb7, 0xeb, 0x0b, 0x84, 0xf3, 0xeb, 0x73, 0x55, 0x0d, 0x70, 0x51, 0x7f, 0x18,
    0xfe, 0x34, 0xa2, 0x03, 0x92, 0xb0, 0xdd, 0xff, 0x18, 0xfe, 0x34, 0x04, 0x01, 0x29, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
    0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00}; //FROM TLINK TO ESP

int main()
{
    espPacket mypacket;

    mypacket.radiotap_version = 0;
    mypacket.radiotap_pad = 0;
    mypacket.radiotap_lenght = 0x0026;
    mypacket.radiotap_present_1 = 0xa000402f;
    mypacket.radiotap_present_2 = 0xa0000820;
    mypacket.radiotap_present_3 = 0x00000820;
    mypacket.timestamp = 0x000000001ffe32df;
    mypacket.radiotap_flags_shortgi = 0x10;
    mypacket.radiotap_datarate = 0x0c;
    mypacket.radiotap_channel_freq = 0x096c;
    mypacket.radiotap_channel_flags_quarter = 0x00c0; 
    mypacket.radiotap_dbm = 0xd3;
    mypacket.alone = 0x00;
    mypacket.radiotap_rxflags_badplcp = 0x0000;
    mypacket.radiotap_dbm_antsignal1 = 0xd3;
    mypacket.radiotap_antenna1 = 0x00;
    mypacket.radiotap_dbm_antsignal2 = 0xc7;
    mypacket.radiotap_antenna2 = 0x01;

    mypacket.wlan_fc_subtype = 0xd0;
    mypacket.wlan_fc_order = 0x00;
    mypacket.wlan_duration = 0x013a;

    mypacket.wlan_da[0] = 0x84;
    mypacket.wlan_da[1] = 0xf3;
    mypacket.wlan_da[2] = 0xeb;
    mypacket.wlan_da[3] = 0x73;
    mypacket.wlan_da[4] = 0x55;
    mypacket.wlan_da[5] = 0x0d;

    mypacket.wlan_sa[0] = 0xf8;
    mypacket.wlan_sa[1] = 0x1a;
    mypacket.wlan_sa[2] = 0x67;
    mypacket.wlan_sa[3] = 0xb7;
    mypacket.wlan_sa[4] = 0xeb;
    mypacket.wlan_sa[5] = 0x0b;

    mypacket.wlan_bssid[0] = 0x84;
    mypacket.wlan_bssid[1] = 0xf3;
    mypacket.wlan_bssid[2] = 0xeb;
    mypacket.wlan_bssid[3] = 0x73;
    mypacket.wlan_bssid[4] = 0x55;
    mypacket.wlan_bssid[5] = 0x0d;

    mypacket.wlan_seq = 0x5170;
    mypacket.wlan_fiwed_category_code = 0x7f;
    mypacket.wlan_tag_oui[0] = 0x18;
    mypacket.wlan_tag_oui[1] = 0xfe;
    mypacket.wlan_tag_oui[2] = 0x34;

    mypacket.data[0] = 0xa2;
    mypacket.data[1] = 0x03;
    mypacket.data[2] = 0x92;
    mypacket.data[3] = 0xb0;
    mypacket.data[4] = 0xdd;
    mypacket.data[5] = 0xff;
    mypacket.data[6] = 0x18;
    mypacket.data[7] = 0xfe;
    mypacket.data[8] = 0x34;
    mypacket.data[9] = 0x04;    
    mypacket.data[10] = 0x1; 
    mypacket.data[11] = 0x29; 

    int i;
     for (i = 12; i <(261); i++)
    {
        mypacket.data[i] = 0x12;
    }  

    mypacket.wlan_fcs = 0x00000000;


printf ("%lu \n",sizeof(espPacket));

uint8_t* mypacketRaw;
mypacketRaw=(uint8_t*)&mypacket; 

int error=0;

    for (i = 0; i <(sizeof(espPacket))-0; i++)
    {
        if (mypacketRaw[i]!=data[i]) {
            printf("!");
            error=1;
        }
        printf("%02x ",mypacketRaw[i]);
        printf("%02x \n",data[i]);
    } 

    if (error!=0)printf("ERROR\n");
}